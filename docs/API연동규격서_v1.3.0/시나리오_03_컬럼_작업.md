# ì‹œë‚˜ë¦¬ì˜¤ 03: ì»¬ëŸ¼ ì‘ì—…

## ëª©ì°¨
1. [ì»¬ëŸ¼ ìƒì„±](#1-ì»¬ëŸ¼-ìƒì„±)
2. [ì»¬ëŸ¼ ìˆ˜ì •](#2-ì»¬ëŸ¼-ìˆ˜ì •)
3. [ì»¬ëŸ¼ ìˆœì„œ ë³€ê²½](#3-ì»¬ëŸ¼-ìˆœì„œ-ë³€ê²½)
4. [ì»¬ëŸ¼ ì‚­ì œ](#4-ì»¬ëŸ¼-ì‚­ì œ)
5. [ì™„ì „í•œ ì‘ì—… í”Œë¡œìš°](#5-ì™„ì „í•œ-ì‘ì—…-í”Œë¡œìš°)

---

## 1. ì»¬ëŸ¼ ìƒì„±

### 1-1. REST APIë¡œ ì»¬ëŸ¼ ìƒì„±

**í”„ë¡ íŠ¸ â†’ ë°±: POST ìš”ì²­**
```javascript
async function createColumn(tableKey, columnData) {
  const response = await fetch(`/api/v1/erd/tables/${tableKey}/columns`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    credentials: 'include',
    body: JSON.stringify({
      logicalName: 'íšŒì› ì•„ì´ë””',      // ë…¼ë¦¬ëª… (í•„ìˆ˜)
      physicalName: 'member_id',       // ë¬¼ë¦¬ëª… (í•„ìˆ˜)
      dataType: 'BIGINT',              // ë°ì´í„° íƒ€ì… (í•„ìˆ˜)
      dataDetail: [],                  // íƒ€ì… ìƒì„¸ (ì„ íƒ)
      isPrimaryKey: true,              // PK ì—¬ë¶€
      isNullable: false,               // NULL í—ˆìš© ì—¬ë¶€
      isUnique: true,                  // UNIQUE ì—¬ë¶€
      isIncremental: true,             // AUTO_INCREMENT ì—¬ë¶€
      defaultValue: null,              // ê¸°ë³¸ê°’
      comment: 'ì‚¬ìš©ì ê³ ìœ  ID'        // ì£¼ì„
    })
  });

  if (!response.ok) {
    throw new Error('ì»¬ëŸ¼ ìƒì„± ì‹¤íŒ¨');
  }

  const result = await response.json();
  console.log('ì»¬ëŸ¼ ìƒì„± ì„±ê³µ:', result);

  return result;
}

// ì‚¬ìš© ì˜ˆì‹œ
createColumn(10, columnData);
```

**ë°ì´í„° íƒ€ì…ë³„ dataDetail ì˜ˆì‹œ:**
```javascript
// VARCHAR(255)
{
  dataType: 'VARCHAR',
  dataDetail: ['255']
}

// DECIMAL(10, 2)
{
  dataType: 'DECIMAL',
  dataDetail: ['10', '2']
}

// INT (ìƒì„¸ ì—†ìŒ)
{
  dataType: 'INT',
  dataDetail: []
}
```

### 1-2. WebSocket ì´ë²¤íŠ¸ ìˆ˜ì‹ 

**ë°± â†’ ëª¨ë“  í”„ë¡ íŠ¸: ColumnNewEvent**
```javascript
stompClient.subscribe('/topic/project/123', (message) => {
  const event = JSON.parse(message.body);

  if (event.type === 'ColumnNewEvent') {
    const column = event.event;

    // í…Œì´ë¸”ì— ì»¬ëŸ¼ ì¶”ê°€
    addColumnToTable(column.tableKey, {
      columnKey: column.columnKey,
      logicalName: column.logicalName,
      physicalName: column.physicalName,
      dataType: column.dataType,
      dataDetail: column.dataDetail,
      isPrimaryKey: column.isPrimaryKey,
      isNullable: column.isNullable,
      isUnique: column.isUnique,
      columnOrder: column.columnOrder
    });

    console.log(`ìƒˆ ì»¬ëŸ¼ ìƒì„±ë¨: ${column.logicalName}`);
  }
});

function addColumnToTable(tableKey, column) {
  const tableElement = document.querySelector(`[data-table-key="${tableKey}"]`);
  const columnsContainer = tableElement.querySelector('.columns-container');

  // ì»¬ëŸ¼ ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„±
  const columnElement = document.createElement('div');
  columnElement.className = 'column-row';
  columnElement.dataset.columnKey = column.columnKey;
  columnElement.dataset.columnOrder = column.columnOrder;

  // PK ì•„ì´ì½˜
  const pkIcon = column.isPrimaryKey ? 'ğŸ”‘' : '';

  // NULL í‘œì‹œ
  const nullText = column.isNullable ? 'NULL' : 'NOT NULL';

  // ë°ì´í„° íƒ€ì… í‘œì‹œ
  let dataTypeText = column.dataType;
  if (column.dataDetail.length > 0) {
    dataTypeText += `(${column.dataDetail.join(', ')})`;
  }

  columnElement.innerHTML = `
    <span class="pk-icon">${pkIcon}</span>
    <span class="logical-name">${column.logicalName}</span>
    <span class="physical-name">${column.physicalName}</span>
    <span class="data-type">${dataTypeText}</span>
    <span class="nullable">${nullText}</span>
  `;

  columnsContainer.appendChild(columnElement);
}
```

**ì´ë²¤íŠ¸ ë°ì´í„° êµ¬ì¡°:**
```javascript
{
  "type": "ColumnNewEvent",
  "projectKey": 123,
  "userKey": 456,
  "event": {
    "columnKey": 101,
    "tableKey": 10,
    "logicalName": "íšŒì› ì•„ì´ë””",
    "physicalName": "member_id",
    "dataType": "BIGINT",
    "dataDetail": [],
    "isPrimaryKey": true,
    "isNullable": false,
    "isUnique": true,
    "isIncremental": true,
    "defaultValue": null,
    "comment": "ì‚¬ìš©ì ê³ ìœ  ID",
    "columnOrder": 1,
    "createdAt": "2025-01-14T12:03:00Z"
  }
}
```

---

## 2. ì»¬ëŸ¼ ìˆ˜ì •

### 2-1. REST APIë¡œ ì»¬ëŸ¼ ìˆ˜ì •

**í”„ë¡ íŠ¸ â†’ ë°±: PATCH ìš”ì²­**
```javascript
async function updateColumn(columnKey, updates) {
  const response = await fetch(`/api/v1/erd/columns/${columnKey}`, {
    method: 'PATCH',
    headers: {
      'Content-Type': 'application/json'
    },
    credentials: 'include',
    body: JSON.stringify({
      logicalName: 'ì‚¬ìš©ì ì´ë©”ì¼',    // ë…¼ë¦¬ëª… ë³€ê²½ (ì„ íƒ)
      physicalName: 'user_email',     // ë¬¼ë¦¬ëª… ë³€ê²½ (ì„ íƒ)
      dataType: 'VARCHAR',            // íƒ€ì… ë³€ê²½ (ì„ íƒ)
      dataDetail: ['255'],            // íƒ€ì… ìƒì„¸ ë³€ê²½ (ì„ íƒ)
      isNullable: true,               // NULL í—ˆìš© ë³€ê²½ (ì„ íƒ)
      comment: 'ì´ë©”ì¼ ì£¼ì†Œ'          // ì£¼ì„ ë³€ê²½ (ì„ íƒ)
    })
  });

  if (!response.ok) {
    throw new Error('ì»¬ëŸ¼ ìˆ˜ì • ì‹¤íŒ¨');
  }

  return await response.json();
}

// ì‚¬ìš© ì˜ˆì‹œ
updateColumn(101, {
  logicalName: 'ì‚¬ìš©ì ì´ë©”ì¼',
  dataType: 'VARCHAR',
  dataDetail: ['255']
});
```

### 2-2. WebSocket ì´ë²¤íŠ¸ ìˆ˜ì‹ 

**ë°± â†’ ëª¨ë“  í”„ë¡ íŠ¸: ColumnUpdateEvent**
```javascript
if (event.type === 'ColumnUpdateEvent') {
  const column = event.event;

  // ì»¬ëŸ¼ ì •ë³´ ì—…ë°ì´íŠ¸
  updateColumn(column.columnKey, {
    logicalName: column.logicalName,
    physicalName: column.physicalName,
    dataType: column.dataType,
    dataDetail: column.dataDetail,
    isNullable: column.isNullable,
    comment: column.comment
  });

  console.log(`ì»¬ëŸ¼ ${column.columnKey} ìˆ˜ì •ë¨`);
}

function updateColumn(columnKey, updates) {
  const columnElement = document.querySelector(`[data-column-key="${columnKey}"]`);

  if (!columnElement) return;

  // ë…¼ë¦¬ëª… ì—…ë°ì´íŠ¸
  if (updates.logicalName) {
    const logicalNameElement = columnElement.querySelector('.logical-name');
    logicalNameElement.textContent = updates.logicalName;
  }

  // ë¬¼ë¦¬ëª… ì—…ë°ì´íŠ¸
  if (updates.physicalName) {
    const physicalNameElement = columnElement.querySelector('.physical-name');
    physicalNameElement.textContent = updates.physicalName;
  }

  // ë°ì´í„° íƒ€ì… ì—…ë°ì´íŠ¸
  if (updates.dataType) {
    let dataTypeText = updates.dataType;
    if (updates.dataDetail && updates.dataDetail.length > 0) {
      dataTypeText += `(${updates.dataDetail.join(', ')})`;
    }

    const dataTypeElement = columnElement.querySelector('.data-type');
    dataTypeElement.textContent = dataTypeText;
  }

  // NULL í—ˆìš© ì—¬ë¶€ ì—…ë°ì´íŠ¸
  if (typeof updates.isNullable !== 'undefined') {
    const nullableElement = columnElement.querySelector('.nullable');
    nullableElement.textContent = updates.isNullable ? 'NULL' : 'NOT NULL';
  }
}
```

---

## 3. ì»¬ëŸ¼ ìˆœì„œ ë³€ê²½

### 3-1. ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ìˆœì„œ ë³€ê²½

**í”„ë¡ íŠ¸: ë“œë˜ê·¸ ì´ë²¤íŠ¸ ì²˜ë¦¬**
```javascript
let draggedColumnElement = null;

function onColumnDragStart(event) {
  draggedColumnElement = event.target;
  event.target.classList.add('dragging');
}

function onColumnDragOver(event) {
  event.preventDefault();

  const columnsContainer = event.target.closest('.columns-container');
  const afterElement = getDragAfterElement(columnsContainer, event.clientY);

  if (afterElement == null) {
    columnsContainer.appendChild(draggedColumnElement);
  } else {
    columnsContainer.insertBefore(draggedColumnElement, afterElement);
  }
}

function onColumnDragEnd(event) {
  event.target.classList.remove('dragging');

  // ìƒˆ ìˆœì„œ ê³„ì‚°
  const columnsContainer = event.target.closest('.columns-container');
  const columnElements = Array.from(columnsContainer.querySelectorAll('.column-row'));

  const columnKey = parseInt(event.target.dataset.columnKey);
  const newOrder = columnElements.indexOf(event.target) + 1;

  // WebSocketìœ¼ë¡œ ìˆœì„œ ë³€ê²½ ì „ì†¡
  reorderColumn(columnKey, newOrder);

  draggedColumnElement = null;
}

function getDragAfterElement(container, y) {
  const draggableElements = [
    ...container.querySelectorAll('.column-row:not(.dragging)')
  ];

  return draggableElements.reduce((closest, child) => {
    const box = child.getBoundingClientRect();
    const offset = y - box.top - box.height / 2;

    if (offset < 0 && offset > closest.offset) {
      return { offset: offset, element: child };
    } else {
      return closest;
    }
  }, { offset: Number.NEGATIVE_INFINITY }).element;
}

// ì»¬ëŸ¼ ì—˜ë¦¬ë¨¼íŠ¸ì— ë“œë˜ê·¸ ì´ë²¤íŠ¸ ë“±ë¡
columnElement.draggable = true;
columnElement.addEventListener('dragstart', onColumnDragStart);
columnElement.addEventListener('dragover', onColumnDragOver);
columnElement.addEventListener('dragend', onColumnDragEnd);
```

### 3-2. WebSocketìœ¼ë¡œ ìˆœì„œ ë³€ê²½ ì „ì†¡

**í”„ë¡ íŠ¸ â†’ ë°±: ColumnOrderEvent ë°œí–‰**
```javascript
function reorderColumn(columnKey, newOrder) {
  console.log(`ì»¬ëŸ¼ ${columnKey} ìˆœì„œ ë³€ê²½: ${newOrder}`);

  // WebSocketìœ¼ë¡œ ìˆœì„œ ë³€ê²½ ì „ì†¡
  stompClient.send('/pub/erd/column/reorder', {}, JSON.stringify({
    columnKey: columnKey,
    columnOrder: newOrder
  }));
}
```

**ë°±ì—”ë“œ ì²˜ë¦¬:**
1. PostgreSQL DB ì—…ë°ì´íŠ¸ (`columnOrder` ì»¬ëŸ¼)
2. Kafka ë¸Œë¡œë“œìºìŠ¤íŠ¸

### 3-3. WebSocket ì´ë²¤íŠ¸ ìˆ˜ì‹ 

**ë°± â†’ ëª¨ë“  í”„ë¡ íŠ¸: ColumnOrderEvent**
```javascript
if (event.type === 'ColumnOrderEvent') {
  const { columnKey, columnOrder } = event.event;

  // ì»¬ëŸ¼ ìˆœì„œ ì¬ì •ë ¬
  reorderColumnInDOM(columnKey, columnOrder);

  console.log(`ì»¬ëŸ¼ ${columnKey} ìˆœì„œ ë³€ê²½: ${columnOrder}`);
}

function reorderColumnInDOM(columnKey, newOrder) {
  const columnElement = document.querySelector(`[data-column-key="${columnKey}"]`);
  if (!columnElement) return;

  const columnsContainer = columnElement.parentElement;
  const columnElements = Array.from(columnsContainer.querySelectorAll('.column-row'));

  // í˜„ì¬ ìœ„ì¹˜ì—ì„œ ì œê±°
  columnElement.remove();

  // ìƒˆ ìœ„ì¹˜ì— ì‚½ì…
  if (newOrder <= 1) {
    // ë§¨ ì•ì— ì‚½ì…
    columnsContainer.insertBefore(columnElement, columnElements[0]);
  } else if (newOrder >= columnElements.length) {
    // ë§¨ ë’¤ì— ì‚½ì…
    columnsContainer.appendChild(columnElement);
  } else {
    // ì¤‘ê°„ì— ì‚½ì…
    columnsContainer.insertBefore(columnElement, columnElements[newOrder - 1]);
  }

  // ìˆœì„œ ì†ì„± ì—…ë°ì´íŠ¸
  columnElement.dataset.columnOrder = newOrder;
}
```

**ì´ë²¤íŠ¸ íƒ€ì…: B (WebSocket + DB + Kafka)**
- âœ… WebSocketìœ¼ë¡œ ë°œí–‰
- âœ… DB ì—…ë°ì´íŠ¸ í›„ Kafka ë¸Œë¡œë“œìºìŠ¤íŠ¸
- âœ… Batch Compression ì ìš©

---

## 4. ì»¬ëŸ¼ ì‚­ì œ

### 4-1. REST APIë¡œ ì»¬ëŸ¼ ì‚­ì œ

**í”„ë¡ íŠ¸ â†’ ë°±: DELETE ìš”ì²­**
```javascript
async function deleteColumn(columnKey) {
  // í™•ì¸ ëŒ€í™”ìƒì
  if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
    return;
  }

  const response = await fetch(`/api/v1/erd/columns/${columnKey}`, {
    method: 'DELETE',
    credentials: 'include'
  });

  if (!response.ok) {
    throw new Error('ì»¬ëŸ¼ ì‚­ì œ ì‹¤íŒ¨');
  }

  console.log('ì»¬ëŸ¼ ì‚­ì œ ìš”ì²­ ì„±ê³µ');

  return await response.json();
}

// ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ
deleteButton.addEventListener('click', () => {
  deleteColumn(columnKey);
});
```

**ë°±ì—”ë“œ ì²˜ë¦¬:**
1. PostgreSQLì—ì„œ **Soft Delete** (deletedAt ì»¬ëŸ¼ ì—…ë°ì´íŠ¸)
2. **PK/FKì¸ ê²½ìš° ê´€ë ¨ ê´€ê³„ë„ í•¨ê»˜ ì‚­ì œ**
3. Kafka ë¸Œë¡œë“œìºìŠ¤íŠ¸

### 4-2. WebSocket ì´ë²¤íŠ¸ ìˆ˜ì‹ 

**ë°± â†’ ëª¨ë“  í”„ë¡ íŠ¸: ColumnDelEvent**
```javascript
if (event.type === 'ColumnDelEvent') {
  const { columnKey } = event.event;

  // ì»¬ëŸ¼ ì œê±°
  removeColumnFromDOM(columnKey);

  console.log(`ì»¬ëŸ¼ ${columnKey} ì‚­ì œë¨`);
}

function removeColumnFromDOM(columnKey) {
  const columnElement = document.querySelector(`[data-column-key="${columnKey}"]`);

  if (columnElement) {
    // ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
    columnElement.classList.add('deleting');

    setTimeout(() => {
      columnElement.remove();
    }, 300);  // 300ms í›„ ì œê±°
  }
}
```

**ì£¼ì˜ì‚¬í•­:**
- âœ… PK/FK ì»¬ëŸ¼ ì‚­ì œ ì‹œ ê´€ë ¨ ê´€ê³„ë„ ìë™ ì‚­ì œë¨
- âœ… ê´€ê³„ ì‚­ì œ ì´ë²¤íŠ¸(`RelationDelEvent`)ë„ í•¨ê»˜ ë°œìƒ

---

## 5. ì™„ì „í•œ ì‘ì—… í”Œë¡œìš°

### ì‹œë‚˜ë¦¬ì˜¤: í…Œì´ë¸”ì— ì—¬ëŸ¬ ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ê³  ìˆœì„œ ì¡°ì •

```javascript
async function createMemberTable() {
  // ========== 1. í…Œì´ë¸” ìƒì„± ==========
  const tableResponse = await fetch('/api/v1/erd/projects/123/tables', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    credentials: 'include',
    body: JSON.stringify({
      logicalName: 'íšŒì›',
      physicalName: 'members',
      xPosition: 100,
      yPosition: 200,
      colorHex: 'FF6B6B'
    })
  });

  const tableResult = await tableResponse.json();
  const tableKey = tableResult.data.tableKey;

  console.log('í…Œì´ë¸” ìƒì„± ì™„ë£Œ:', tableKey);

  // ========== 2. ì»¬ëŸ¼ ìƒì„± (PK) ==========
  const idColumnResponse = await fetch(`/api/v1/erd/tables/${tableKey}/columns`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    credentials: 'include',
    body: JSON.stringify({
      logicalName: 'íšŒì› ì•„ì´ë””',
      physicalName: 'member_id',
      dataType: 'BIGINT',
      isPrimaryKey: true,
      isNullable: false,
      isUnique: true,
      isIncremental: true,
      comment: 'íšŒì› ê³ ìœ  ID'
    })
  });

  const idColumn = await idColumnResponse.json();
  console.log('PK ì»¬ëŸ¼ ìƒì„± ì™„ë£Œ:', idColumn.data.columnKey);

  // ========== 3. ì»¬ëŸ¼ ìƒì„± (ì´ë©”ì¼) ==========
  const emailColumnResponse = await fetch(`/api/v1/erd/tables/${tableKey}/columns`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    credentials: 'include',
    body: JSON.stringify({
      logicalName: 'ì´ë©”ì¼',
      physicalName: 'email',
      dataType: 'VARCHAR',
      dataDetail: ['255'],
      isPrimaryKey: false,
      isNullable: false,
      isUnique: true,
      comment: 'ë¡œê·¸ì¸ ì´ë©”ì¼'
    })
  });

  const emailColumn = await emailColumnResponse.json();
  console.log('ì´ë©”ì¼ ì»¬ëŸ¼ ìƒì„± ì™„ë£Œ:', emailColumn.data.columnKey);

  // ========== 4. ì»¬ëŸ¼ ìƒì„± (ì´ë¦„) ==========
  const nameColumnResponse = await fetch(`/api/v1/erd/tables/${tableKey}/columns`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    credentials: 'include',
    body: JSON.stringify({
      logicalName: 'ì´ë¦„',
      physicalName: 'name',
      dataType: 'VARCHAR',
      dataDetail: ['100'],
      isPrimaryKey: false,
      isNullable: false,
      comment: 'íšŒì› ì´ë¦„'
    })
  });

  const nameColumn = await nameColumnResponse.json();
  console.log('ì´ë¦„ ì»¬ëŸ¼ ìƒì„± ì™„ë£Œ:', nameColumn.data.columnKey);

  // ========== 5. ì»¬ëŸ¼ ìˆœì„œ ë³€ê²½ (ì´ë¦„ì„ ì´ë©”ì¼ ì•ìœ¼ë¡œ) ==========
  await new Promise(resolve => setTimeout(resolve, 1000));  // 1ì´ˆ ëŒ€ê¸°

  stompClient.send('/pub/erd/column/reorder', {}, JSON.stringify({
    columnKey: nameColumn.data.columnKey,
    columnOrder: 2  // ì´ë©”ì¼(3) â†’ ì´ë¦„(2), ì´ë©”ì¼(3)
  }));

  console.log('ì»¬ëŸ¼ ìˆœì„œ ë³€ê²½ ì™„ë£Œ');

  // ========== 6. ì»¬ëŸ¼ ìˆ˜ì • (ì´ë©”ì¼ ê¸¸ì´ í™•ì¥) ==========
  await new Promise(resolve => setTimeout(resolve, 1000));

  await fetch(`/api/v1/erd/columns/${emailColumn.data.columnKey}`, {
    method: 'PATCH',
    headers: { 'Content-Type': 'application/json' },
    credentials: 'include',
    body: JSON.stringify({
      dataDetail: ['320']  // RFC 5321: ìµœëŒ€ 320ì
    })
  });

  console.log('ì´ë©”ì¼ ì»¬ëŸ¼ ìˆ˜ì • ì™„ë£Œ');

  console.log('íšŒì› í…Œì´ë¸” êµ¬ì„± ì™„ë£Œ!');
}

// ì‹¤í–‰
createMemberTable();
```

**ê²°ê³¼ í…Œì´ë¸” êµ¬ì¡°:**
```
íšŒì› (members)
â”œâ”€ ğŸ”‘ member_id: BIGINT, PK, AUTO_INCREMENT, NOT NULL, UNIQUE
â”œâ”€ name: VARCHAR(100), NOT NULL
â””â”€ email: VARCHAR(320), NOT NULL, UNIQUE
```

---

## 6. ë°ì´í„° íƒ€ì… ê°€ì´ë“œ

### 6-1. ì§€ì›í•˜ëŠ” ë°ì´í„° íƒ€ì…

**ìˆ«ìí˜•:**
```javascript
// INT
{ dataType: 'INT', dataDetail: [] }

// BIGINT
{ dataType: 'BIGINT', dataDetail: [] }

// DECIMAL(10, 2)
{ dataType: 'DECIMAL', dataDetail: ['10', '2'] }

// FLOAT
{ dataType: 'FLOAT', dataDetail: [] }

// DOUBLE
{ dataType: 'DOUBLE', dataDetail: [] }
```

**ë¬¸ìí˜•:**
```javascript
// VARCHAR(255)
{ dataType: 'VARCHAR', dataDetail: ['255'] }

// CHAR(10)
{ dataType: 'CHAR', dataDetail: ['10'] }

// TEXT
{ dataType: 'TEXT', dataDetail: [] }
```

**ë‚ ì§œ/ì‹œê°„í˜•:**
```javascript
// DATE
{ dataType: 'DATE', dataDetail: [] }

// DATETIME
{ dataType: 'DATETIME', dataDetail: [] }

// TIMESTAMP
{ dataType: 'TIMESTAMP', dataDetail: [] }

// TIME
{ dataType: 'TIME', dataDetail: [] }
```

**ê¸°íƒ€:**
```javascript
// BOOLEAN
{ dataType: 'BOOLEAN', dataDetail: [] }

// JSON
{ dataType: 'JSON', dataDetail: [] }

// UUID
{ dataType: 'UUID', dataDetail: [] }
```

### 6-2. ë°ì´í„° íƒ€ì… ë³€í™˜ ì£¼ì˜ì‚¬í•­

**ì•ˆì „í•œ ë³€í™˜:**
- âœ… `INT` â†’ `BIGINT`
- âœ… `VARCHAR(100)` â†’ `VARCHAR(255)`
- âœ… `DATE` â†’ `DATETIME`

**ìœ„í—˜í•œ ë³€í™˜ (ë°ì´í„° ì†ì‹¤ ê°€ëŠ¥):**
- âš ï¸ `BIGINT` â†’ `INT` (ë²”ìœ„ ì´ˆê³¼ ì‹œ ì˜¤ë¥˜)
- âš ï¸ `VARCHAR(255)` â†’ `VARCHAR(100)` (ì˜ë¦¼)
- âš ï¸ `DATETIME` â†’ `DATE` (ì‹œê°„ ì •ë³´ ì†ì‹¤)

**ë°±ì—”ë“œì—ì„œ ê²€ì¦:**
- ìœ„í—˜í•œ ë³€í™˜ ì‹œ ì—ëŸ¬ ì‘ë‹µ ë˜ëŠ” ê²½ê³ 

---

## 7. ì´ë²¤íŠ¸ íƒ€ì… ìš”ì•½

| ì´ë²¤íŠ¸ | ë°œí–‰ ë°©ë²• | íŠ¹ì§• | ì§€ì—°ì‹œê°„ |
|--------|-----------|------|----------|
| **ColumnNewEvent** | REST API (POST) | DB ì €ì¥ + Kafka | 2ì´ˆ ë°°ì¹˜ |
| **ColumnUpdateEvent** | REST API (PATCH) | DB ì €ì¥ + Kafka | 2ì´ˆ ë°°ì¹˜ |
| **ColumnOrderEvent** | WebSocket | DB ì €ì¥ + Kafka | 2ì´ˆ ë°°ì¹˜ |
| **ColumnDelEvent** | REST API (DELETE) | DB Soft Delete + Kafka | 2ì´ˆ ë°°ì¹˜ |

---

## 8. ë””ë²„ê¹… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì»¬ëŸ¼ì´ ìƒì„± ì•ˆë  ë•Œ
- [ ] EDITOR ì´ìƒ ê¶Œí•œì¸ê°€?
- [ ] í…Œì´ë¸” í‚¤ê°€ ì˜¬ë°”ë¥¸ê°€?
- [ ] í•„ìˆ˜ í•„ë“œ(logicalName, physicalName, dataType)ë¥¼ ëª¨ë‘ ì œê³µí–ˆëŠ”ê°€?
- [ ] dataDetail í˜•ì‹ì´ ì˜¬ë°”ë¥¸ê°€? (ë°°ì—´ë¡œ ì „ì†¡)

### ì»¬ëŸ¼ ìˆœì„œê°€ ë³€ê²½ ì•ˆë  ë•Œ
- [ ] WebSocketì´ ì—°ê²°ë˜ì–´ ìˆëŠ”ê°€?
- [ ] `/pub/erd/column/reorder` ì—”ë“œí¬ì¸íŠ¸ê°€ ì˜¬ë°”ë¥¸ê°€?
- [ ] columnOrderê°€ ìœ íš¨í•œ ë²”ìœ„ì¸ê°€? (1 ì´ìƒ)

### ì»¬ëŸ¼ ì‚­ì œ ì‹œ ê´€ê³„ê°€ í•¨ê»˜ ì‚­ì œë˜ëŠ” ê²½ìš°
- [ ] ì‚­ì œí•˜ë ¤ëŠ” ì»¬ëŸ¼ì´ FKì¸ê°€?
- [ ] `RelationDelEvent`ë„ ìˆ˜ì‹ ë˜ëŠ”ê°€?
- [ ] ì˜ë„í•œ ë™ì‘ì¸ê°€? (CASCADE)

---

## 9. ì°¸ê³  ë¬¸ì„œ

- WebSocket ë©”ì‹œì§€ ë ˆí¼ëŸ°ìŠ¤: `07_WebSocket_ë©”ì‹œì§€_ë ˆí¼ëŸ°ìŠ¤.csv`
- REST API ë ˆí¼ëŸ°ìŠ¤: `06_API ë ˆí¼ëŸ°ìŠ¤.csv`
