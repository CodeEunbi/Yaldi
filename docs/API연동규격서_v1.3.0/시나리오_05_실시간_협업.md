# ì‹œë‚˜ë¦¬ì˜¤ 05: ì‹¤ì‹œê°„ í˜‘ì—…

## ëª©ì°¨
1. [ì»¤ì„œ ê³µìœ ](#1-ì»¤ì„œ-ê³µìœ )
2. [ì˜¨ë¼ì¸ ì‚¬ìš©ì ëª©ë¡](#2-ì˜¨ë¼ì¸-ì‚¬ìš©ì-ëª©ë¡)
3. [í¸ì§‘ ì¶©ëŒ ë°©ì§€](#3-í¸ì§‘-ì¶©ëŒ-ë°©ì§€)
4. [ì„±ëŠ¥ ìµœì í™”](#4-ì„±ëŠ¥-ìµœì í™”)

---

## 1. ì»¤ì„œ ê³µìœ 

### 1-1. ì‹¤ì‹œê°„ ì»¤ì„œ ìœ„ì¹˜ ì „ì†¡

**í”„ë¡ íŠ¸ â†’ ë°±: CursorPosEvent ë°œí–‰ (Throttling í•„ìˆ˜)**
```javascript
let lastCursorSent = 0;
const THROTTLE_MS = 50;  // 50ms = 20fps

canvas.addEventListener('mousemove', (event) => {
  const now = Date.now();

  // Throttling: 50msë§ˆë‹¤ë§Œ ì „ì†¡
  if (now - lastCursorSent < THROTTLE_MS) {
    return;
  }

  // ë§ˆìš°ìŠ¤ ì¢Œí‘œ
  const x = event.clientX;
  const y = event.clientY;

  // WebSocketìœ¼ë¡œ ì»¤ì„œ ìœ„ì¹˜ ì „ì†¡
  stompClient.send('/pub/erd/cursor', {}, JSON.stringify({
    projectKey: 123,
    xPosition: x,
    yPosition: y
  }));

  lastCursorSent = now;
});
```

**ë°±ì—”ë“œ ì²˜ë¦¬:**
1. ë°œì‹ ìì˜ userKey, userName, userColor ì¶”ê°€
2. **ì¦‰ì‹œ** ëª¨ë“  êµ¬ë…ìì—ê²Œ ë¸Œë¡œë“œìºìŠ¤íŠ¸
3. **DB/Redis ì €ì¥ ì•ˆí•¨** (ì™„ì „ íœ˜ë°œì„±)
4. Kafka ë¯¸ì‚¬ìš©
5. í‰ê·  ì§€ì—°ì‹œê°„: **60ms**

### 1-2. ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì»¤ì„œ í‘œì‹œ

**ë°± â†’ ëª¨ë“  í”„ë¡ íŠ¸: CursorPosEvent**
```javascript
const remoteCursors = new Map();  // userEmail â†’ ì»¤ì„œ ì—˜ë¦¬ë¨¼íŠ¸

stompClient.subscribe('/topic/project/123', (message) => {
  const event = JSON.parse(message.body);

  if (event.type === 'CursorPosEvent') {
    const cursor = event.event;

    // ë‚´ ì»¤ì„œëŠ” í‘œì‹œ ì•ˆí•¨
    if (cursor.userEmail === currentUserEmail) {
      return;
    }

    // ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì»¤ì„œ í‘œì‹œ
    showRemoteCursor({
      userEmail: cursor.userEmail,
      userName: cursor.userName,
      userColor: cursor.userColor,  // ì´ë©”ì¼ í•´ì‹œ ê¸°ë°˜ ìë™ ìƒì„±
      x: cursor.xPosition,
      y: cursor.yPosition
    });
  }
});

function showRemoteCursor(cursor) {
  let cursorElement = remoteCursors.get(cursor.userEmail);

  // ì»¤ì„œ ì—˜ë¦¬ë¨¼íŠ¸ê°€ ì—†ìœ¼ë©´ ìƒì„±
  if (!cursorElement) {
    cursorElement = document.createElement('div');
    cursorElement.className = 'remote-cursor';
    cursorElement.style.position = 'absolute';
    cursorElement.style.pointerEvents = 'none';
    cursorElement.style.zIndex = '9999';

    // ì»¤ì„œ ëª¨ì–‘ (ë™ê·¸ë¼ë¯¸ + ì´ë¦„í‘œ)
    cursorElement.innerHTML = `
      <div class="cursor-dot" style="
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: ${cursor.userColor};
        border: 2px solid white;
        box-shadow: 0 0 4px rgba(0,0,0,0.3);
      "></div>
      <div class="cursor-label" style="
        margin-left: 15px;
        margin-top: -5px;
        padding: 2px 6px;
        background-color: ${cursor.userColor};
        color: white;
        font-size: 12px;
        border-radius: 3px;
        white-space: nowrap;
      ">${cursor.userName}</div>
    `;

    document.body.appendChild(cursorElement);
    remoteCursors.set(cursor.userEmail, cursorElement);
  }

  // ì»¤ì„œ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
  cursorElement.style.left = cursor.x + 'px';
  cursorElement.style.top = cursor.y + 'px';

  // ì¼ì • ì‹œê°„ í›„ ìë™ ì œê±° (ì»¤ì„œê°€ ë©ˆì¶˜ ê²½ìš°)
  clearTimeout(cursorElement.timeoutId);
  cursorElement.timeoutId = setTimeout(() => {
    cursorElement.style.opacity = '0';
  }, 2000);  // 2ì´ˆ ë™ì•ˆ ì›€ì§ì„ ì—†ìœ¼ë©´ í˜ì´ë“œì•„ì›ƒ
}
```

**ì´ë²¤íŠ¸ ë°ì´í„° êµ¬ì¡°:**
```javascript
{
  "type": "CursorPosEvent",
  "projectKey": 123,
  "userKey": 456,
  "event": {
    "projectKey": 123,
    "userEmail": "user@example.com",
    "userName": "í™ê¸¸ë™",
    "userColor": "#ff6b6b",  // ì´ë©”ì¼ í•´ì‹œ ê¸°ë°˜
    "xPosition": 350.5,
    "yPosition": 420.8
  }
}
```

### 1-3. ë©¤ë²„ í‡´ì¥ ì‹œ ì»¤ì„œ ì œê±°

**MEMBER_LEAVE ì´ë²¤íŠ¸ í™œìš©:**
```javascript
if (event.type === 'MEMBER_LEAVE') {
  const { userEmail } = event.data;

  // í‡´ì¥í•œ ì‚¬ìš©ìì˜ ì»¤ì„œ ì œê±°
  const cursorElement = remoteCursors.get(userEmail);
  if (cursorElement) {
    cursorElement.remove();
    remoteCursors.delete(userEmail);
  }
}
```

---

## 2. ì˜¨ë¼ì¸ ì‚¬ìš©ì ëª©ë¡

### 2-1. ì˜¨ë¼ì¸ ì‚¬ìš©ì ê´€ë¦¬

```javascript
const onlineUsers = new Map();  // userKey â†’ ì‚¬ìš©ì ì •ë³´

// ì—°ê²° ì„±ê³µ ì‹œ ë‚´ ì •ë³´ ì¶”ê°€
if (event.type === 'CONNECTION_ESTABLISHED') {
  const myInfo = event.data;
  onlineUsers.set(myInfo.userKey, {
    userKey: myInfo.userKey,
    role: myInfo.role,
    userName: 'ë‚˜',  // ë‚˜ì¤‘ì— ì‹¤ì œ ì´ë¦„ìœ¼ë¡œ ì—…ë°ì´íŠ¸
    joinedAt: myInfo.serverTime
  });

  updateOnlineUsersUI();
}

// ë‹¤ë¥¸ ì‚¬ìš©ì ì…ì¥
if (event.type === 'MEMBER_JOIN') {
  const user = event.data;
  onlineUsers.set(user.userKey, user);

  showNotification(`${user.userName}ë‹˜ì´ ì…ì¥í–ˆìŠµë‹ˆë‹¤.`, 'info');
  updateOnlineUsersUI();
}

// ì‚¬ìš©ì í‡´ì¥
if (event.type === 'MEMBER_LEAVE') {
  const user = event.data;
  onlineUsers.delete(user.userKey);

  showNotification(`${user.userName}ë‹˜ì´ í‡´ì¥í–ˆìŠµë‹ˆë‹¤.`, 'info');
  updateOnlineUsersUI();
}
```

### 2-2. ì˜¨ë¼ì¸ ì‚¬ìš©ì UI í‘œì‹œ

```javascript
function updateOnlineUsersUI() {
  const container = document.querySelector('#online-users-list');
  container.innerHTML = '';

  // ì˜¨ë¼ì¸ ì‚¬ìš©ì ìˆ˜
  const countElement = document.querySelector('#online-users-count');
  countElement.textContent = onlineUsers.size;

  // ê° ì‚¬ìš©ì í‘œì‹œ
  onlineUsers.forEach((user, userKey) => {
    const userElement = document.createElement('div');
    userElement.className = 'online-user';
    userElement.dataset.userKey = userKey;

    // ê¶Œí•œë³„ ì•„ì´ì½˜
    let roleIcon = '';
    if (user.role === 'OWNER') roleIcon = 'ğŸ‘‘';
    else if (user.role === 'EDITOR') roleIcon = 'âœï¸';
    else if (user.role === 'VIEWER') roleIcon = 'ğŸ‘ï¸';

    userElement.innerHTML = `
      <span class="user-avatar" style="background-color: ${getUserColor(user.userEmail)}">
        ${user.userName.charAt(0)}
      </span>
      <span class="user-name">${user.userName}</span>
      <span class="user-role">${roleIcon}</span>
      <span class="online-indicator"></span>
    `;

    container.appendChild(userElement);
  });
}

// ì´ë©”ì¼ë¡œ ìƒ‰ìƒ ìƒì„± (ì»¤ì„œ ìƒ‰ìƒê³¼ ë™ì¼)
function getUserColor(email) {
  if (!email) return '#999';

  let hash = 0;
  for (let i = 0; i < email.length; i++) {
    hash = email.charCodeAt(i) + ((hash << 5) - hash);
  }

  const hue = hash % 360;
  return `hsl(${hue}, 70%, 60%)`;
}
```

---

## 3. í¸ì§‘ ì¶©ëŒ ë°©ì§€

### 3-1. í…Œì´ë¸” ì ê¸ˆ ì‹œê°ì  í‘œì‹œ

```javascript
const lockedTables = new Map();  // tableKey â†’ ì ê¸ˆ ì •ë³´

// í…Œì´ë¸” ì ê¸ˆ ì´ë²¤íŠ¸
if (event.type === 'TableLockEvent') {
  const { tableKey, userEmail, userName } = event.event;

  lockedTables.set(tableKey, { userEmail, userName });

  // í…Œì´ë¸” ì ê¸ˆ í‘œì‹œ
  showTableLocked(tableKey, userName, userEmail === currentUserEmail);
}

// í…Œì´ë¸” ì ê¸ˆ í•´ì œ ì´ë²¤íŠ¸
if (event.type === 'TableUnlockEvent') {
  const { tableKey } = event.event;

  lockedTables.delete(tableKey);

  // í…Œì´ë¸” ì ê¸ˆ í•´ì œ í‘œì‹œ
  hideTableLocked(tableKey);
}

function showTableLocked(tableKey, userName, isMe) {
  const tableElement = document.querySelector(`[data-table-key="${tableKey}"]`);

  // ì ê¸ˆ ì˜¤ë²„ë ˆì´
  const lockOverlay = document.createElement('div');
  lockOverlay.className = 'lock-overlay';
  lockOverlay.dataset.tableKey = tableKey;

  if (isMe) {
    // ë‚´ê°€ ì ê·¼ ê²½ìš°: í¸ì§‘ ê°€ëŠ¥
    lockOverlay.style.backgroundColor = 'rgba(76, 175, 80, 0.1)';
    lockOverlay.style.border = '2px solid #4CAF50';
    lockOverlay.innerHTML = `
      <div class="lock-message">
        <span class="lock-icon">ğŸ”“</span>
        <span>í¸ì§‘ ì¤‘...</span>
      </div>
    `;
  } else {
    // ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ì ê·¼ ê²½ìš°: ì½ê¸° ì „ìš©
    lockOverlay.style.backgroundColor = 'rgba(255, 107, 107, 0.1)';
    lockOverlay.style.border = '2px solid #ff6b6b';
    lockOverlay.innerHTML = `
      <div class="lock-message">
        <span class="lock-icon">ğŸ”’</span>
        <span>${userName}ë‹˜ì´ í¸ì§‘ ì¤‘</span>
      </div>
    `;

    // í¸ì§‘ ë²„íŠ¼ ë¹„í™œì„±í™”
    const editButton = tableElement.querySelector('.edit-button');
    if (editButton) {
      editButton.disabled = true;
    }
  }

  tableElement.appendChild(lockOverlay);
}

function hideTableLocked(tableKey) {
  const lockOverlay = document.querySelector(`.lock-overlay[data-table-key="${tableKey}"]`);
  if (lockOverlay) {
    lockOverlay.remove();
  }

  // í¸ì§‘ ë²„íŠ¼ í™œì„±í™”
  const tableElement = document.querySelector(`[data-table-key="${tableKey}"]`);
  const editButton = tableElement.querySelector('.edit-button');
  if (editButton) {
    editButton.disabled = false;
  }
}
```

### 3-2. í¸ì§‘ ì‹œë„ ì „ ì ê¸ˆ í™•ì¸

```javascript
function onTableDoubleClick(tableKey) {
  // ì´ë¯¸ ì ê¸´ í…Œì´ë¸”ì¸ì§€ í™•ì¸
  if (lockedTables.has(tableKey)) {
    const lockInfo = lockedTables.get(tableKey);

    if (lockInfo.userEmail !== currentUserEmail) {
      showError(`${lockInfo.userName}ë‹˜ì´ ì´ë¯¸ í¸ì§‘ ì¤‘ì…ë‹ˆë‹¤.`);
      return;
    }
  }

  // ì ê¸ˆ ìš”ì²­
  stompClient.send('/pub/erd/table/lock', {}, JSON.stringify({
    tableKey: tableKey
  }));
}
```

### 3-3. ë™ì‹œ í¸ì§‘ ê°ì§€

```javascript
// ë“œë˜ê·¸ ì¤‘ì¸ í…Œì´ë¸”ì„ ë‹¤ë¥¸ ì‚¬ìš©ìë„ ë“œë˜ê·¸í•˜ëŠ” ê²½ìš°
const myDraggingTables = new Set();

function onTableDragStart(tableKey) {
  myDraggingTables.add(tableKey);
}

function onTableDragEnd(tableKey) {
  myDraggingTables.delete(tableKey);
}

// TableMoveEvent ìˆ˜ì‹  ì‹œ
if (event.type === 'TableMoveEvent') {
  const { tableKey, xPosition, yPosition } = event.event;

  // ë‚´ê°€ ë“œë˜ê·¸ ì¤‘ì¸ í…Œì´ë¸”ì´ë©´ ë¬´ì‹œ
  if (myDraggingTables.has(tableKey)) {
    return;
  }

  // ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë“œë˜ê·¸ ì¤‘
  moveTable(tableKey, xPosition, yPosition);

  // ë™ì‹œ í¸ì§‘ ê²½ê³  í‘œì‹œ (ì„ íƒ)
  if (myDraggingTables.size > 0) {
    showWarning('ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë™ì‹œì— í…Œì´ë¸”ì„ ì´ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤.');
  }
}
```

---

## 4. ì„±ëŠ¥ ìµœì í™”

### 4-1. Throttling (ì»¤ì„œ/ë“œë˜ê·¸)

**ì»¤ì„œ ì „ì†¡ ì œí•œ: 50ms (20fps)**
```javascript
class ThrottledSender {
  constructor(stompClient, throttleMs = 50) {
    this.stompClient = stompClient;
    this.throttleMs = throttleMs;
    this.lastSent = new Map();  // destination â†’ timestamp
  }

  send(destination, data) {
    const now = Date.now();
    const lastTime = this.lastSent.get(destination) || 0;

    if (now - lastTime < this.throttleMs) {
      return false;  // ì „ì†¡ ìŠ¤í‚µ
    }

    this.stompClient.send(destination, {}, JSON.stringify(data));
    this.lastSent.set(destination, now);

    return true;  // ì „ì†¡ ì„±ê³µ
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const throttledSender = new ThrottledSender(stompClient, 50);

canvas.addEventListener('mousemove', (event) => {
  throttledSender.send('/pub/erd/cursor', {
    projectKey: 123,
    xPosition: event.clientX,
    yPosition: event.clientY
  });
});
```

### 4-2. Debouncing (ê²€ìƒ‰/ì…ë ¥)

**í…Œì´ë¸” ì´ë¦„ ì‹¤ì‹œê°„ í¸ì§‘: 300ms ëŒ€ê¸°**
```javascript
class DebouncedSender {
  constructor(stompClient, debounceMs = 300) {
    this.stompClient = stompClient;
    this.debounceMs = debounceMs;
    this.timers = new Map();  // destination â†’ timer
  }

  send(destination, data) {
    // ì´ì „ íƒ€ì´ë¨¸ ì·¨ì†Œ
    const timer = this.timers.get(destination);
    if (timer) {
      clearTimeout(timer);
    }

    // ìƒˆ íƒ€ì´ë¨¸ ì„¤ì •
    const newTimer = setTimeout(() => {
      this.stompClient.send(destination, {}, JSON.stringify(data));
      this.timers.delete(destination);
    }, this.debounceMs);

    this.timers.set(destination, newTimer);
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const debouncedSender = new DebouncedSender(stompClient, 300);

tableNameInput.addEventListener('input', (event) => {
  debouncedSender.send('/pub/erd/table/name', {
    tableKey: 10,
    logicalName: event.target.value
  });
});
```

### 4-3. Rate Limiting (ì†ë„ ì œí•œ)

**ì´ˆë‹¹ ìµœëŒ€ 10ê°œ ë©”ì‹œì§€**
```javascript
class RateLimiter {
  constructor(maxPerSecond = 10) {
    this.max = maxPerSecond;
    this.queue = [];
  }

  send(stompClient, destination, data) {
    const now = Date.now();

    // 1ì´ˆ ì´ë‚´ ë©”ì‹œì§€ í•„í„°ë§
    this.queue = this.queue.filter(t => now - t < 1000);

    // Rate Limit ì´ˆê³¼ í™•ì¸
    if (this.queue.length >= this.max) {
      console.warn('Rate limit exceeded. Message dropped.');
      return false;
    }

    // ì „ì†¡
    stompClient.send(destination, {}, JSON.stringify(data));
    this.queue.push(now);

    return true;
  }

  getRemaining() {
    const now = Date.now();
    this.queue = this.queue.filter(t => now - t < 1000);
    return this.max - this.queue.length;
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const rateLimiter = new RateLimiter(10);

function sendMessage(destination, data) {
  if (!rateLimiter.send(stompClient, destination, data)) {
    showError('ë©”ì‹œì§€ ì „ì†¡ì´ ë„ˆë¬´ ë¹ ë¦…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.');
  }
}
```

### 4-4. ì´ë²¤íŠ¸ ì¤‘ë³µ ì œê±°

**ë™ì¼í•œ ì´ë²¤íŠ¸ ì¤‘ë³µ ìˆ˜ì‹  ë°©ì§€**
```javascript
class EventDeduplicator {
  constructor(ttl = 10000) {  // 10ì´ˆ TTL
    this.processed = new Map();  // eventId â†’ timestamp
    this.ttl = ttl;
  }

  isDuplicate(event) {
    // ì´ë²¤íŠ¸ ê³ ìœ  ID ìƒì„±
    const eventId = this.getEventId(event);

    // ì¤‘ë³µ í™•ì¸
    if (this.processed.has(eventId)) {
      console.log('Duplicate event ignored:', eventId);
      return true;
    }

    // ê¸°ë¡
    this.processed.set(eventId, Date.now());

    // TTL ë§Œë£Œëœ í•­ëª© ì œê±°
    this.cleanup();

    return false;
  }

  getEventId(event) {
    const { type, event: data } = event;

    if (type === 'TableMoveEvent') {
      return `${type}_${data.tableKey}_${data.xPosition}_${data.yPosition}`;
    } else if (type === 'TableNewEvent') {
      return `${type}_${data.tableKey}`;
    } else if (type === 'ColumnNewEvent') {
      return `${type}_${data.columnKey}`;
    }

    return `${type}_${JSON.stringify(data)}`;
  }

  cleanup() {
    const now = Date.now();
    for (const [eventId, timestamp] of this.processed.entries()) {
      if (now - timestamp > this.ttl) {
        this.processed.delete(eventId);
      }
    }
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const deduplicator = new EventDeduplicator(10000);

stompClient.subscribe('/topic/project/123', (message) => {
  const event = JSON.parse(message.body);

  // ì¤‘ë³µ ì²´í¬
  if (deduplicator.isDuplicate(event)) {
    return;  // ì¤‘ë³µ ì´ë²¤íŠ¸ ë¬´ì‹œ
  }

  // ì´ë²¤íŠ¸ ì²˜ë¦¬
  handleEvent(event);
});
```

### 4-5. ì—°ê²° ìƒíƒœ ëª¨ë‹ˆí„°ë§

```javascript
class ConnectionMonitor {
  constructor(stompClient) {
    this.stompClient = stompClient;
    this.isConnected = false;
    this.lastHeartbeat = Date.now();
    this.heartbeatInterval = null;
  }

  start() {
    // 1ì´ˆë§ˆë‹¤ ì—°ê²° ìƒíƒœ í™•ì¸
    this.heartbeatInterval = setInterval(() => {
      const now = Date.now();
      const elapsed = now - this.lastHeartbeat;

      if (elapsed > 60000) {  // 60ì´ˆ ë™ì•ˆ Heartbeat ì—†ìŒ
        console.warn('Connection timeout detected');
        this.onTimeout();
      } else if (elapsed > 30000) {  // 30ì´ˆ ê²½ê³ 
        console.warn('Slow connection detected');
        updateConnectionStatus('slow');
      } else {
        updateConnectionStatus('connected');
      }
    }, 1000);
  }

  onHeartbeat() {
    this.lastHeartbeat = Date.now();
  }

  onTimeout() {
    clearInterval(this.heartbeatInterval);
    updateConnectionStatus('disconnected');
    showError('ì„œë²„ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤. ì¬ì—°ê²° ì¤‘...');

    // ì¬ì—°ê²° ì‹œë„
    setTimeout(() => {
      reconnect();
    }, 2000);
  }

  stop() {
    clearInterval(this.heartbeatInterval);
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const monitor = new ConnectionMonitor(stompClient);
monitor.start();

stompClient.subscribe('/topic/project/123', (message) => {
  monitor.onHeartbeat();  // ë©”ì‹œì§€ ìˆ˜ì‹  ì‹œ Heartbeat ê°±ì‹ 
  handleEvent(JSON.parse(message.body));
});
```

---

## 5. ì™„ì „í•œ í˜‘ì—… ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤: 2ëª…ì˜ ì‚¬ìš©ìê°€ ë™ì‹œì— ERD í¸ì§‘

**ì‚¬ìš©ì A (EDITOR):**
```javascript
// 1. í”„ë¡œì íŠ¸ ì ‘ì†
wsManager.connect(123);

// 2. ë©¤ë²„ ì…ì¥ ì´ë²¤íŠ¸ ìˆ˜ì‹  (ì‚¬ìš©ì B)
// â†’ "ê¹€ì² ìˆ˜ë‹˜ì´ ì…ì¥í–ˆìŠµë‹ˆë‹¤." ì•Œë¦¼

// 3. í…Œì´ë¸” ìƒì„±
createTable(123, { logicalName: 'íšŒì›', ... });

// 4. ì»¤ì„œ ì´ë™ (ì‚¬ìš©ì Bì˜ ì»¤ì„œë„ ë³´ì„)
canvas.addEventListener('mousemove', sendCursorPosition);

// 5. í…Œì´ë¸” ë”ë¸”í´ë¦­ â†’ ì ê¸ˆ íšë“
onTableDoubleClick(10);

// 6. ì»¬ëŸ¼ ì¶”ê°€
createColumn(10, { logicalName: 'íšŒì› ì•„ì´ë””', ... });

// 7. í¸ì§‘ ì™„ë£Œ â†’ ì ê¸ˆ í•´ì œ
onTableEditComplete(10);
```

**ì‚¬ìš©ì B (EDITOR):**
```javascript
// 1. í”„ë¡œì íŠ¸ ì ‘ì†
wsManager.connect(123);

// 2. Aê°€ ë§Œë“  í…Œì´ë¸” ì‹¤ì‹œê°„ í‘œì‹œ
// â†’ TableNewEvent ìˆ˜ì‹ 

// 3. Aì˜ ì»¤ì„œ ì‹¤ì‹œê°„ í‘œì‹œ
// â†’ CursorPosEvent ìˆ˜ì‹ 

// 4. Aê°€ ì ê·¼ í…Œì´ë¸” í‘œì‹œ
// â†’ "í™ê¸¸ë™ë‹˜ì´ í¸ì§‘ ì¤‘" ì˜¤ë²„ë ˆì´

// 5. Aê°€ ì¶”ê°€í•œ ì»¬ëŸ¼ ì‹¤ì‹œê°„ í‘œì‹œ
// â†’ ColumnNewEvent ìˆ˜ì‹ 

// 6. Aê°€ ì ê¸ˆ í•´ì œ
// â†’ ì´ì œ Bë„ í¸ì§‘ ê°€ëŠ¥
```

---

## 6. ë””ë²„ê¹… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì»¤ì„œê°€ ì•ˆë³´ì¼ ë•Œ
- [ ] CursorPosEvent í•¸ë“¤ëŸ¬ê°€ ë“±ë¡ë˜ì–´ ìˆëŠ”ê°€?
- [ ] Throttlingìœ¼ë¡œ ë„ˆë¬´ ëŠë¦¬ê²Œ ì „ì†¡í•˜ëŠ”ê°€?
- [ ] ë‚´ ì»¤ì„œë¥¼ ì œì™¸í•˜ëŠ” ë¡œì§ì´ ì˜¬ë°”ë¥¸ê°€?
- [ ] z-indexê°€ ë‚®ì•„ì„œ ê°€ë ¤ì§€ëŠ”ê°€?

### ì ê¸ˆì´ ì‘ë™ ì•ˆí•  ë•Œ
- [ ] Redisê°€ ì •ìƒ ë™ì‘í•˜ëŠ”ê°€?
- [ ] TableLockEvent í•¸ë“¤ëŸ¬ê°€ ë“±ë¡ë˜ì–´ ìˆëŠ”ê°€?
- [ ] ì—°ê²° í•´ì œ ì‹œ ìë™ í•´ì œê°€ ì‘ë™í•˜ëŠ”ê°€?

### ì„±ëŠ¥ì´ ëŠë¦´ ë•Œ
- [ ] Throttling/Debouncingì„ ì ìš©í–ˆëŠ”ê°€?
- [ ] Rate Limitì— ê±¸ë ¸ëŠ”ê°€?
- [ ] ì´ë²¤íŠ¸ ì¤‘ë³µ ì œê±°ë¥¼ í•˜ê³  ìˆëŠ”ê°€?
- [ ] ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì´ ìˆëŠ”ê°€? (ping í™•ì¸)

---

## 7. ì°¸ê³  ë¬¸ì„œ

- WebSocket ë©”ì‹œì§€ ë ˆí¼ëŸ°ìŠ¤: `07_WebSocket_ë©”ì‹œì§€_ë ˆí¼ëŸ°ìŠ¤.csv`
- ì‹œë‚˜ë¦¬ì˜¤ 01: ì—°ê²° ë° ì¸ì¦: `ì‹œë‚˜ë¦¬ì˜¤_01_ì—°ê²°_ë°_ì¸ì¦.md`
- ì‹œë‚˜ë¦¬ì˜¤ 02: í…Œì´ë¸” ì‘ì—…: `ì‹œë‚˜ë¦¬ì˜¤_02_í…Œì´ë¸”_ì‘ì—….md`
